<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Forecasting bitcoin value with ARIMA</title>

<script src="site_libs/header-attrs-2.20/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link rel="apple-touch-icon" sizes="57x57" href="icons/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="icons/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="icons/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="icons/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="icons/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="icons/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="icons/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="icons/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="icons/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="icons/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="icons/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
<link rel="manifest" href="manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="icons/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #232629;
    color: #7a7c7d;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #7a7c7d;  padding-left: 4px; }
div.sourceCode
  { color: #cfcfc2; background-color: #232629; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #cfcfc2; } /* Normal */
code span.al { color: #95da4c; background-color: #4d1f24; font-weight: bold; } /* Alert */
code span.an { color: #3f8058; } /* Annotation */
code span.at { color: #2980b9; } /* Attribute */
code span.bn { color: #f67400; } /* BaseN */
code span.bu { color: #7f8c8d; } /* BuiltIn */
code span.cf { color: #fdbc4b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #3daee9; } /* Char */
code span.cn { color: #27aeae; font-weight: bold; } /* Constant */
code span.co { color: #7a7c7d; } /* Comment */
code span.cv { color: #7f8c8d; } /* CommentVar */
code span.do { color: #a43340; } /* Documentation */
code span.dt { color: #2980b9; } /* DataType */
code span.dv { color: #f67400; } /* DecVal */
code span.er { color: #da4453; text-decoration: underline; } /* Error */
code span.ex { color: #0099ff; font-weight: bold; } /* Extension */
code span.fl { color: #f67400; } /* Float */
code span.fu { color: #8e44ad; } /* Function */
code span.im { color: #27ae60; } /* Import */
code span.in { color: #c45b00; } /* Information */
code span.kw { color: #cfcfc2; font-weight: bold; } /* Keyword */
code span.op { color: #cfcfc2; } /* Operator */
code span.ot { color: #27ae60; } /* Other */
code span.pp { color: #27ae60; } /* Preprocessor */
code span.re { color: #2980b9; background-color: #153042; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #da4453; } /* SpecialString */
code span.st { color: #f44f4f; } /* String */
code span.va { color: #27aeae; } /* Variable */
code span.vs { color: #da4453; } /* VerbatimString */
code span.wa { color: #da4453; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="about_me.html">About Me</a>
</li>
<li>
  <a href="resume.html">Resume</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="matern-spatial.html">Spatial modeling of school gun violence</a>
    </li>
    <li>
      <a href="ergm_models.html">Sexual network exponential random graph modeling</a>
    </li>
    <li>
      <a href="wine-classification.html">Classifying wine quality</a>
    </li>
    <li>
      <a href="bitcoin.html">Forecasting bitcoin value</a>
    </li>
    <li>
      <a href="housing-prices.html">Predicting housing prices</a>
    </li>
    <li>
      <a href="https://pinchunchen.shinyapps.io/ggomoku/">Play Gomoku using Shiny</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Contact Me
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="mailto:jsteven.raquel8@gmail.com">jsteven.raquel8@gmail.com</a>
    </li>
    <li>
      <a href="https://github.com/jstevenr">GitHub</a>
    </li>
    <li>
      <a href="https://www.linkedin.com/in/jstevenr/">LinkedIn</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Forecasting bitcoin value with ARIMA</h1>

</div>


<p>This was my final project for PSTAT 174, Time Series, Fall 2017. It
has been changed slightly from the time it was completed to this version
you see here.</p>
<hr />
<div id="abstract" class="section level1">
<h1>Abstract</h1>
<p>This analysis attempts to build an accurate forecasting model for the
opening price of the bitcoin cryptocurrency, using data from an entire
year and the Box-Jenkins methodology. This process consisted of model
identification (after Box-Cox transformation and differencing), model
selection by comparing AICc, parameter estimation using maximum
likelihood estimation, and finally model diagnostics from looking at the
ACF and PACF of the residuals.</p>
<p>As it turns out, the two models with the lowest AICc, ARIMA(2,1,1)
and ARIMA(1,1,2), were similarly flawed on account of the inherent
heteroskedasticity in the original data, which was discovered when
running model diagnostics.</p>
<p>Ultimately it was decided that the ARIMA model was unfeasible for
modeling this particular dataset. Having said that, both models resulted
in very similar results and confidence intervals that contain the true
values, with the ARIMA(2,1,1) model <span class="math inline">\(X_t -
0.0546X_{t-1} = Z_t + 0.0167Z_{t-1} + 0.0536Z_{t-2}\)</span> proving
only slightly more effective when forecasting only 10 values into the
future. It is suggested perhaps that the GARCH model which more
effectively deals with heteroskedastic data would be better for
forecasting this data.</p>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This dataset is the opening price of the cryptocurrency bitcoin for
366 days, I chose a random year (October 9 2015 - October 8 2016).
Cryptocurrency is a digital currency, with bitcoin being the most
well-known. It is untraceable and is known for its usage for purchasing
illicit goods and services. With internet anonymity and privacy becoming
more important in the modern day, the value of untraceable currency has
skyrocketed in the past several years. I want to be able to forecast the
value of bitcoin in the future, based off of its value in the past. The
dataset was found on <a
href="https://www.kaggle.com/sudalairajkumar/cryptocurrencypricehistory/kernels">Kaggle.com</a>,
which in turn got the data from <a
href="https://coinmarketcap.com/">coinmarketcap.com</a>.</p>
</div>
<div id="body" class="section level1">
<h1>Body</h1>
<div id="preliminary-plots" class="section level2">
<h2>Preliminary Plots</h2>
<p>To first analyze the dataset, I want to read in the data and then
plot its time series. The data is organized to where the values are the
top are the most recent, and those at the bottom are the oldest, so I
will have to reverse this. I’m going to subset the data to a certain
range in the middle so that I can compare my forecasting with actual
existing data. After doing this, I will plot the series along a trend
line or ‘line of best fit’.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">&quot;data&quot;</span>, <span class="st">&quot;bitcoin_price.csv&quot;</span>)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(Date, Open))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Date <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(df<span class="sc">$</span>Date, <span class="st">&quot;%b %d, %Y&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[<span class="fu">order</span>(df<span class="sc">$</span>Date), ]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># taking a 356 observation subset of the data</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>df_sub <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">subset</span>(Date <span class="sc">&gt;=</span> <span class="st">&quot;2015-10-09&quot;</span> <span class="sc">&amp;</span> Date <span class="sc">&lt;=</span> <span class="st">&quot;2016-10-08&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting with a LOESS line</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_sub, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Open, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Date&quot;</span>) <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;USD&quot;</span>) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Opening Price of Bitcoin&quot;</span>) <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">level =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bitcoin_files/figure-html/initial%20plot-1.png" width="672" /></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>open <span class="ot">&lt;-</span> <span class="fu">as.ts</span>(df_sub<span class="sc">$</span>Open)</span></code></pre></div>
</div>
<div id="trend-seasonality-and-sharp-changes" class="section level2">
<h2>Trend, Seasonality and Sharp Changes</h2>
<p>There is a very clear upward trend in the data, several sharp
changes, and the mean is in no way constant over time. All of these are
red flags that the data is not stationary. I do not believe from looking
at the data that seasonality is an issue since there is no consistent
change that occurs periodically. The issue of the trend can and will be
addressed via differencing, and similarly seasonality can be addressed
in this way but we need not do that here. The sharp changes do make a
difference in terms of the variance, which we will attempt to make
constant via power transformations such as through the Box-Cox
transformation.</p>
</div>
<div id="transforming" class="section level2">
<h2>Transforming</h2>
<p>With the end goal of forecasting, the first step after looking at the
data is to transform it to make it stationary, i.e. make it so the
future behaves as the past. In order to determine the best way to do
that, we should look at the ACF (auto-covariance) and PACF (partial
auto-covariance) plots, which depict how data are affected by the
observations that precede them. This will also give us an idea of the
model for the data.</p>
<p>The <em>autocorrelation</em> of data, represented by the function
<span class="math inline">\(\gamma_X\)</span> for some data <span
class="math inline">\(X\)</span>, is the correlation in the data between
two different points in time. One of the conditions for stationarity of
a dataset is for the autocorrelation between two points in time <span
class="math inline">\(t_1\)</span> and <span
class="math inline">\(t_2\)</span> to be equal to the autocorrelation of
the difference between <span class="math inline">\(t_1\)</span> and
<span class="math inline">\(t_2\)</span>. The <em>partial
autocorrelation</em> is the original ACF, controlling for the values of
the time series at all shorter lags. Properties of these plots help us
determine the order of the AR and MA components of our ARMA model.</p>
<p>AR (auto-regressive) models depend on their past values, an error
term, and sometimes a constant. MA (moving average) models depend
linearly on the current and past values of white noise error terms
(which is random). The combination of them, together with differencing,
consitute the ARIMA model.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(forecast) is loaded</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggtsdisplay</span>(open)</span></code></pre></div>
<p><img src="bitcoin_files/figure-html/ACF%20and%20PACF-1.png" width="672" /></p>
<p>The ACF of the data decays gradually, whereas the PACF cuts off
abruptly. The gradual decay of the ACF tells us that we should
difference the data, which would also address the issue of the upward
trend.</p>
<div id="box-cox-transformation" class="section level3">
<h3>Box-Cox Transformation</h3>
<p>We would like to begin by using the Box-Cox power transformation,
which is a method that helps to Normalize data. This method finds a
value <span class="math inline">\(\lambda\)</span> which maximizes the
log-likelihood and then the data is raised to the power of <span
class="math inline">\(\lambda\)</span>. The higher the likelihood, the
better (more likely) the model parameter. Power transformations such as
the Box-Cox help to stabilize the variance which is imperative for
Box-Jenkins modeling.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(MASS) is loaded</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>bcTransform <span class="ot">&lt;-</span> <span class="fu">boxcox</span>(open <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(open)))</span></code></pre></div>
<p><img src="bitcoin_files/figure-html/finding%20best%20lambda-1.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># value of lambda which maxes log-likelihood</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>best.lambda <span class="ot">&lt;-</span> bcTransform<span class="sc">$</span>x[<span class="fu">which</span>(bcTransform<span class="sc">$</span>y <span class="sc">==</span> <span class="fu">max</span>(bcTransform<span class="sc">$</span>y))]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>best.lambda</span></code></pre></div>
<pre><code>## [1] 0.1818182</code></pre>
<p>We see that the ideal value for <span
class="math inline">\(\lambda\)</span> that maximizes the likelihood is
<span class="math inline">\(0.181\)</span>, but the log function, <span
class="math inline">\(\lambda = 0\)</span>, is within the confidence
interval so we can use this instead. Here we will apply the
transformation, then compare the variances of our original data with the
transformed data.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transforming the data</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df_sub<span class="sc">$</span>Open_tr <span class="ot">&lt;-</span> <span class="fu">log</span>(open)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># new time series plot</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_sub, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Open_tr, <span class="at">group =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Date&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;USD (after log transformation)&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Series after Box-Cox&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">level =</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>## Don&#39;t know how to automatically pick scale for object of type &lt;ts&gt;. Defaulting to continuous.
## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="bitcoin_files/figure-html/box-cox%20transformation-1.png" width="672" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing the variances of original and transformed data</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(open)</span></code></pre></div>
<pre><code>## [1] 14166.75</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(df_sub<span class="sc">$</span>Open_tr)</span></code></pre></div>
<pre><code>## [1] 0.06487496</code></pre>
<p>Obviously the data still has a linear trend, but the variance is much
smaller. We haven’t differenced yet, so the upward trend is still
apparent. The typical methodology is to difference at <span
class="math inline">\(d = 1\)</span> when dealing with a linear upward
trend such as this.</p>
</div>
<div id="differencing" class="section level3">
<h3>Differencing</h3>
<p>We only want to difference once and at lag 1 because we did not
observe any seasonality when we first plotted the original time series.
The differenced series will represent the <em>change</em> between
observations that are <span class="math inline">\(d\)</span> units of
time apart, in this case, <span class="math inline">\(d = 1\)</span>,
which is to say one day apart. So our differenced (and transformed) data
will represent the change from each value to the next, one day at a
time.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>open_diff <span class="ot">&lt;-</span> <span class="fu">diff</span>(df_sub<span class="sc">$</span>Open_tr, <span class="at">lag =</span> <span class="dv">1</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(open_diff) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Series after Differencing at lag 1 after Box-Cox&quot;</span>)</span></code></pre></div>
<p><img src="bitcoin_files/figure-html/differencing-1.png" width="672" /></p>
<p>Note that the y-intercept for the trend line is now approximately
zero, so our upward trend has been nullified by the differencing. It
does concern us that the variance does not appear to be constant
throughout (heteroskedasticity) in spite of the Box-Cox transformation
being applied, which is theoretically the best power transformation
available. In the graph it is noted how the variance is extremely small
at certain points, and at other times very large. We can however proceed
with an augmented Dickey-Fuller test which will determine whether the
data is stationary or not by checking against null hypothesis that the
sample has a unit root. If it doesn’t, then it is stationary.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(tseries) is loaded</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">adf.test</span>(open_diff, <span class="at">alternative =</span> <span class="st">&quot;stationary&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in adf.test(open_diff, alternative = &quot;stationary&quot;): p-value smaller than
## printed p-value</code></pre>
<pre><code>## 
##  Augmented Dickey-Fuller Test
## 
## data:  open_diff
## Dickey-Fuller = -7.0202, Lag order = 7, p-value = 0.01
## alternative hypothesis: stationary</code></pre>
<p>Our p-value of <span class="math inline">\(0.01\)</span> being lower
than confidence level <span class="math inline">\(\alpha = 0.05\)</span>
gives us significant evidence to reject the null hypothesis that the
data is not stationary, thereby concluding that it is. Satisfied by
this, we can now move on with estimating the parameters of the
model.</p>
</div>
</div>
<div id="parameter-estimation" class="section level2">
<h2>Parameter Estimation</h2>
<p>Now we want to try and estimate the order of the model i.e. values of
<span class="math inline">\(p\)</span> and <span
class="math inline">\(q\)</span>. We can start speculating on these
values by plotting the ACF and PACF of the newly differenced series. We
can get ideas on what the orders are by using the
<code>auto.arima()</code> function on the original time series, as well
as the ACF and PACF of our transformed series. We’ll include <span
class="math inline">\(\lambda = 0\)</span> as a part of our function so
that it estimates a model of our Box-Cox transformed data.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(forecast) is loaded</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># stepwise and approximation = F is slower, but more accurate</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>auto.fit <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(open, <span class="at">stepwise =</span> F, <span class="at">approximation =</span> F, <span class="at">lambda =</span> <span class="dv">0</span>, <span class="at">ic =</span> <span class="st">&quot;aicc&quot;</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>auto.fit</span></code></pre></div>
<pre><code>## Series: open 
## ARIMA(0,1,4) with drift 
## Box Cox transformation: lambda= 0 
## 
## Coefficients:
##          ma1      ma2      ma3     ma4   drift
##       0.0462  -0.0766  -0.0212  0.1660  0.0026
## s.e.  0.0519   0.0513   0.0503  0.0556  0.0017
## 
## sigma^2 = 0.000833:  log likelihood = 778.57
## AIC=-1545.14   AICc=-1544.91   BIC=-1521.74</code></pre>
<p>Note the inclusion of a ‘drift’ constant in the model. The
<code>auto.arima()</code> function only includes the drift if it
improves the model, based on AICc, which is the information criterion we
specified to judge the model on, something that will be explained in
more detail later on. We note that the drift <span
class="math inline">\(\mu = 0.0026\)</span> with standard error <span
class="math inline">\(0.0017\)</span>, so the confidence interval for it
actually includes zero hinting at this being a rather insignificant
drift.</p>
<p>We are given an ARIMA(0,1,4) model in this case which means it was
differenced at lag 1 just like we did earlier, and also the order is
<span class="math inline">\(q = 4\)</span>.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(open_diff) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;ACF of transformed data&quot;</span>)</span></code></pre></div>
<p><img src="bitcoin_files/figure-html/ACF-PACF%20of%20differenced%20data-1.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggPacf</span>(open_diff) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;PACF of transformed data&quot;</span>)</span></code></pre></div>
<p><img src="bitcoin_files/figure-html/ACF-PACF%20of%20differenced%20data-2.png" width="672" /></p>
<p>The ACF at lag 1 is not significantly far form zero, so we don’t
difference further lest we overdifference the series.</p>
<p>Looking at 25 lags of this series, we see that there are few lags at
which the ACF or PACF are significant. The ACF is significant at lag 4
(implying <span class="math inline">\(p = 4\)</span>) and the PACF is
significant at lag <span class="math inline">\(q = 4\)</span> which is
consistent with the model from the <code>auto.arima</code>.</p>
<div id="akaike-information-criterion" class="section level3">
<h3>Akaike Information Criterion</h3>
<p>AICc is a refinement of the AIC (Akaike Information Criterion), which
is a formula based on the number of estimated parameters as well as the
maximum likelihood estimator. The smaller the AIC, the stronger the
model. The AICc corrects for finite sample sizes, addressing an issue
with the AIC which can result in overfitting models, so we prefer it
when fitting for an ARIMA model.</p>
<p>It is however important to note that the AIC (and AICc) depend on a
model being univariate, linear, and with normally-distributed residuals.
We know the first two are true from what we have done so far, but are
unsure about the latter condition. It is something that we will diagnose
in the model diagnostics.</p>
</div>
</div>
<div id="model-selection" class="section level2">
<h2>Model Selection</h2>
<p>For now we will just use the AICc to select a couple of models and
determine later on if the residuals will be an issue.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix of AIC values for p and q</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="co"># library(qpcR) and library(forecast) are loaded</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>AICc.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">5</span>, <span class="at">ncol =</span> <span class="dv">5</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">&quot;p =&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>),</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">&quot;q =&quot;</span>, <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># simulating arima models for p,q = 0,1,2,3,4 and d = 1</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (q <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    AICc.mat[p <span class="sc">+</span> <span class="dv">1</span>, q <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">AICc</span>(<span class="fu">Arima</span>(open,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">order =</span> <span class="fu">c</span>(p, <span class="dv">1</span>, q),</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">&quot;ML&quot;</span>, <span class="at">lambda =</span> <span class="dv">0</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="co"># printing matrix</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>AICc.mat</span></code></pre></div>
<pre><code>##           q = 0     q = 1     q = 2     q = 3     q = 4
## p = 0 -1541.736 -1540.275 -1539.475 -1537.564 -1544.742
## p = 1 -1540.202 -1538.621 -1537.460 -1539.345 -1543.171
## p = 2 -1539.853 -1537.820 -1541.075 -1541.256 -1541.248
## p = 3 -1537.821 -1535.777 -1541.447 -1536.959 -1539.292
## p = 4 -1542.163 -1541.295 -1539.960 -1538.658 -1542.195</code></pre>
<p>We see that the model with the <em>lowest</em> AICC is the
ARIMA(1,1,2) model with an AICc of <span
class="math inline">\(-1538.392\)</span>, but all of them are very close
to one another. The ARIMA(2,1,1) is pretty similar with an AICc of <span
class="math inline">\(-1538.822\)</span>.</p>
<p>We want to estimate as few parameters as possible due to the
principle of parsimony (to select as few parameters as possible). In our
case, the more parameters there are, the weaker the model. We can fit a
couple of different models and compare. It is generally advisable in
fact to stick to models in which at least one of <span
class="math inline">\(p\)</span> and <span
class="math inline">\(q\)</span> is no larger than 1, since this is
likely to lead to overfitting.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ARIMA(1,1,2)</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>fit112 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(open, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="at">method =</span> <span class="st">&quot;ML&quot;</span>, <span class="at">lambda =</span> <span class="dv">0</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>fit112</span></code></pre></div>
<pre><code>## Series: open 
## ARIMA(1,1,2) 
## Box Cox transformation: lambda= 0 
## 
## Coefficients:
##          ar1      ma1      ma2
##       0.0546  -0.0167  -0.0536
## s.e.  0.4038   0.4003   0.0487
## 
## sigma^2 = 0.0008555:  log likelihood = 772.76
## AIC=-1537.53   AICc=-1537.41   BIC=-1521.93</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ARIMA(2,1,1)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>fit211 <span class="ot">&lt;-</span> <span class="fu">Arima</span>(open, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">method =</span> <span class="st">&quot;ML&quot;</span>, <span class="at">lambda =</span> <span class="dv">0</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>fit211</span></code></pre></div>
<pre><code>## Series: open 
## ARIMA(2,1,1) 
## Box Cox transformation: lambda= 0 
## 
## Coefficients:
##          ar1      ar2     ma1
##       0.0287  -0.0671  0.0098
## s.e.  0.3504   0.0538  0.3480
## 
## sigma^2 = 0.0008546:  log likelihood = 772.94
## AIC=-1537.89   AICc=-1537.78   BIC=-1522.29</code></pre>
<p>So, we have the ARIMA(1,1,2) model <span class="math display">\[X_t -
0.0546X_{t-1} = Z_t + 0.0167Z_{t-1} + 0.0536Z_{t-2}\]</span> and the
ARIMA(2,1,1) model <span class="math display">\[X_t - 0.0287X_{t-1} +
0.0671X_{t-2} = Z_t - 0.0098Z_{t-1}\]</span></p>
<p>where <span class="math inline">\(Z_t\)</span> should be
approximately white noise with mean <span
class="math inline">\(0\)</span> and variance <span
class="math inline">\(\sigma^2_Z\)</span>. It’s important to note that
these parameters have large confidence intervals that also include 0
(which imply that the random drift model may apply in this case).</p>
</div>
<div id="model-diagnostics" class="section level2">
<h2>Model Diagnostics</h2>
<p>For us to proceed with forecasting with these ARIMA models, the
residuals must be IID (independent, identically distributed) Gaussian
white noise–that is, there is no trend, no seasonality and no change in
variance, as well as a sample mean of approximately zero, and a variance
of approximately 1.</p>
<p>We can conduct the Ljung-Box test, the McLeod-Li test, and the
Shapiro-Wilk test for normality on our model’s residuals for model
diagnostics.</p>
<p>The Ljung-Box test tests some data against the null hypothesis that
the data <em>are</em> independently distributed. The McLeod-Li test is
the same as conducting the Ljung-Box test, but on the <em>squared</em>
residuals instead. The implication of rejecting the null in the
McLeod-Li test but passing the Ljung-Box test is an inherent problem of
non-constant variance (heteroskedasticity), which is something we noted
before in preliminary plots before and after transforming and
differencing. The Shapiro-Wilk tests against the null hypothesis that
the data are Normal, the other important condition of an ARIMA model’s
validity. Here we create a matrix comparing the p-values of each of the
hypothesis tests on each model.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>resids112 <span class="ot">&lt;-</span> fit112<span class="sc">$</span>residuals</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>resids211 <span class="ot">&lt;-</span> fit211<span class="sc">$</span>residuals</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(open)))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># a matrix comparing p-values for the three different tests</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>diag.mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;ARIMA(1,1,2)&quot;</span>, <span class="st">&quot;ARIMA(2,1,1)&quot;</span>),</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">&quot;Ljung-Box&quot;</span>, <span class="st">&quot;McLeod-Li&quot;</span>, <span class="st">&quot;Shapiro-Wilk&quot;</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co"># testing ARIMA(0,1,0) residuals</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>diag.mat[<span class="dv">1</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">Box.test</span>(resids112, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>, <span class="at">lag =</span> k, <span class="at">fitdf =</span> <span class="dv">0</span>)<span class="sc">$</span>p.value</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>diag.mat[<span class="dv">1</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">Box.test</span>(resids112<span class="sc">^</span><span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>, <span class="at">lag =</span> k, <span class="at">fitdf =</span> <span class="dv">0</span>)<span class="sc">$</span>p.value</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>diag.mat[<span class="dv">1</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(resids112)<span class="sc">$</span>p.value</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co"># testing ARIMA(2,1,0) residuals</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>diag.mat[<span class="dv">2</span>, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">Box.test</span>(resids211, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>, <span class="at">lag =</span> k, <span class="at">fitdf =</span> <span class="dv">2</span>)<span class="sc">$</span>p.value</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>diag.mat[<span class="dv">2</span>, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">Box.test</span>(resids211<span class="sc">^</span><span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>, <span class="at">lag =</span> k, <span class="at">fitdf =</span> <span class="dv">2</span>)<span class="sc">$</span>p.value</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>diag.mat[<span class="dv">2</span>, <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(resids211)<span class="sc">$</span>p.value</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix of p-values</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(diag.mat, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##              Ljung-Box McLeod-Li Shapiro-Wilk
## ARIMA(1,1,2)     0.670         0            0
## ARIMA(2,1,1)     0.558         0            0</code></pre>
<p>In the case of both models, the residuals <em>fail to reject</em> the
null hypothesis in the Ljung-Box test, but have overwhelming evidence to
reject it in the case of the McLeod-Li and the Shapiro-Wilk test. All
tests use an <span class="math inline">\(\alpha = 0.05\)</span>
confidence level. These conclusions imply that while the residuals are
all independently distributed, the squared residuals are not. They also
tell us that the residuals are not Normally distributed. The fact that
the squared residuals are correlated and the lack of normality are both
major pitfalls in our ARIMA models, since our model selection and our
forecasting are contingent on these assumptions.</p>
<p>Failing to reject the null hypothesis of the Ljung-Box test but
rejecting the null hypothesis of the McLeod-Li test tells us that our
data might be more typical of a GARCH (generalized auto-regressive
conditional heteroskedasticity) model rather than ARIMA as we have
fitted here. With the addendum that our model is not necessarily the
best one available, we will run diagnostic checks on the rest of the
model and proceed with forecasting anyway, just to see what happens.</p>
</div>
<div id="forecasting" class="section level2">
<h2>Forecasting</h2>
<p>Now we will proceed with forecasting the next 10 values in the time
series using both the ARIMA(1,1,2) and the ARIMA(2,1,1) models, and
compare the results with each other and with the true values.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(forecast) is loaded</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>forecast112 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(df_sub<span class="sc">$</span>Open, <span class="at">model =</span> fit112, <span class="at">lambda =</span> <span class="dv">0</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>forecast211 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(df_sub<span class="sc">$</span>Open, <span class="at">model =</span> fit211, <span class="at">lambda =</span> <span class="dv">0</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting true values and the forecasts</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>df_add <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">subset</span>(Date <span class="sc">&gt;=</span> <span class="st">&quot;2015-10-09&quot;</span> <span class="sc">&amp;</span> Date <span class="sc">&lt;=</span> <span class="st">&quot;2016-10-18&quot;</span>)</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>open_add <span class="ot">&lt;-</span> <span class="fu">as.ts</span>(df_add<span class="sc">$</span>Open)</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="co"># True Values</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(open_add, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">375</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Days from 10/09/15&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;USD&quot;</span>) <span class="sc">+</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;True Values for Opening Price of Bitcoin, 2016-08-03 - 2016-10-18&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 300 rows containing missing values (`geom_line()`).</code></pre>
<p><img src="bitcoin_files/figure-html/forecasting-1.png" width="672" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ARIMA(1,1,2)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(forecast112, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">375</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Days from 10/09/15&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;USD&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ARIMA(1,1,2) Forecast for Opening Price of Bitcoin, 10 Days ahead&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 299 rows containing missing values (`geom_line()`).</code></pre>
<pre><code>## Warning: Removed 1 row containing missing values (`geom_line()`).</code></pre>
<p><img src="bitcoin_files/figure-html/forecasting-2.png" width="672" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ARIMA (2,1,1)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(forecast211, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">300</span>, <span class="dv">375</span>)) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;Days from 10/09/15&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;USD&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;ARIMA(2,1,1) Forecast for Opening Price of Bitcoin, 10 Days ahead&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 299 rows containing missing values (`geom_line()`).
## Removed 1 row containing missing values (`geom_line()`).</code></pre>
<p><img src="bitcoin_files/figure-html/forecasting-3.png" width="672" /></p>
<p>As we can see, the ARIMA(2,1,1) is very similar to the ARIMA(1,1,2)
since both models had confidence intervals for their parameters that
made them having close to no model at all other than a random walk. We
do observe that while the forecasts predict a straight line, which the
true values obviously did not follow, at the very least the confidence
intervals of the predictions capture the true values. The further one
goes into the future, the larger the confidence interval i.e. the more
uncertain predictions become.</p>
<p>Here we print out two data frames, one for each model, comparing the
true values, the predictions, the 95% confidence intervals, and the
percent difference between the prediction and the true value (the column
<code>pct.diff</code>). A value of <span
class="math inline">\(4.43\)</span> means that the predicted value is
4.43% <em>bigger</em> than the true value.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>true <span class="ot">&lt;-</span> df_add<span class="sc">$</span>Open[<span class="dv">366</span><span class="sc">:</span><span class="dv">375</span>]</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># data.frame of ARIMA(1,1,2) forecasts</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>df112 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">true =</span> true, <span class="at">pred =</span> forecast112<span class="sc">$</span>mean,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> forecast112<span class="sc">$</span>lower[, <span class="dv">2</span>],</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> forecast112<span class="sc">$</span>upper[, <span class="dv">2</span>],</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">pct.diff =</span> <span class="fu">round</span>((forecast112<span class="sc">$</span>mean <span class="sc">-</span> true) <span class="sc">/</span> true, <span class="dv">4</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>df112</span></code></pre></div>
<pre><code>##      true     pred    lower    upper pct.diff
## 1  617.34 617.5206 583.1163 653.9548     0.03
## 2  619.17 617.2694 568.3204 670.4343    -0.31
## 3  616.82 617.2557 558.4516 682.2518     0.07
## 4  619.24 617.2550 550.2555 692.4123    -0.32
## 5  640.87 617.2549 543.1030 701.5311    -3.68
## 6  636.03 617.2549 536.6973 709.9041    -2.95
## 7  637.01 617.2549 530.8610 717.7088    -3.10
## 8  640.31 617.2549 525.4775 725.0618    -3.60
## 9  639.08 617.2549 520.4648 732.0449    -3.42
## 10 641.82 617.2549 515.7634 738.7179    -3.83</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data.frame of ARIMA(2,1,1) forecasts</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>df211 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">true =</span> true, <span class="at">pred =</span> forecast211<span class="sc">$</span>mean,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">lower =</span> forecast211<span class="sc">$</span>lower[, <span class="dv">2</span>],</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">upper =</span> forecast211<span class="sc">$</span>upper[, <span class="dv">2</span>],</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">pct.diff =</span> <span class="fu">round</span>((forecast211<span class="sc">$</span>mean <span class="sc">-</span> true) <span class="sc">/</span> true, <span class="dv">4</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>df211</span></code></pre></div>
<pre><code>##      true     pred    lower    upper pct.diff
## 1  617.34 617.5149 583.1276 653.9301     0.03
## 2  619.17 617.2013 568.2658 670.3509    -0.32
## 3  616.82 617.1806 558.6474 681.8467     0.06
## 4  619.24 617.2010 550.6802 691.7574    -0.33
## 5  640.87 617.2030 543.6340 700.7279    -3.69
## 6  636.03 617.2017 537.3100 708.9724    -2.96
## 7  637.01 617.2015 531.5488 716.6561    -3.11
## 8  640.31 617.2016 526.2325 723.8963    -3.61
## 9  639.08 617.2016 521.2804 730.7734    -3.42
## 10 641.82 617.2016 516.6340 737.3456    -3.84</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the average error</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df112<span class="sc">$</span>pct.diff)</span></code></pre></div>
<pre><code>## [1] -2.111</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(df211<span class="sc">$</span>pct.diff)</span></code></pre></div>
<pre><code>## [1] -2.119</code></pre>
<p>On average, the predictions of the ARIMA(1,1,2) model were closer to
the true values of the data, although it was very close, with both being
close to 2% off of the true values. Having said that, we do know that
the squared residuals of both of these models are not independent from
each other (they have an auto-correlation) so we can’t technically
declare either of these models truly valid. Also, we have only predicted
10 values into the future here so a larger sample size of predictions is
necessary to determine which in the long-run is stronger.</p>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>Ultimately, our two lowest AICc models produced predictions that were
relatively close to the true data, with the ARIMA(1,1,2) model <span
class="math inline">\(X_t - 0.0546X_{t-1} = Z_t + 0.0167Z_{t-1} +
0.0536Z_{t-2}\)</span> proving only slightly closer than the
ARIMA(2,1,1) <span class="math inline">\(X_t - 0.0287X_{t-1} +
0.0671X_{t-2} = Z_t - 0.0098Z_{t-1}\)</span>, but this was only for
forecasting 10 values. Again it is important to note that both models
did <em>not</em> pass model diagnostics and as such do not carry a lot
of validity.</p>
<p>This dataset was difficult to fit with an ARIMA model because of the
fact that the variance was non-constant, which results in squared
residuals that were dependent on one another. The residuals were also
not Normal, even after transforming with the Box-Cox transformation in
the beginning. Both issues easily apparent in our time series plot of
the original data which has many sporadic bursts up and down. While the
residuals themselves were not autocorrelated, this still does not make
for a forecast-ready model, at least not with ARIMA.</p>
<p>If someone were to accurately forecast on this dataset, it would be
prudent to utilize a GARCH model instead, which better takes into
account the non-constant variance. GARCH is a typical model for
financial data. Considering our dataset in question is concerning the
value of cryptocurrency (which has been extremely variable in the past
several years), prospective analysts would be best advised to utilize
this model in the future.</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>R Core Team (2017). R: A language and environment for statistical
computing. R Foundation for Statistical Computing, Vienna, Austria. URL
<a href="https://www.R-project.org/"
class="uri">https://www.R-project.org/</a>.</p>
<p>Adrian Trapletti and Kurt Hornik (2017). tseries: Time Series
Analysis and Computational Finance. R package version 0.10-42.</p>
<p>Hyndman RJ (2017). <em>forecast: Forecasting functions for time
series and linear models</em>. R package version 8.2, &lt;URL: <a
href="http://pkg.robjhyndman.com/forecast"
class="uri">http://pkg.robjhyndman.com/forecast</a>&gt;.</p>
<p>Hyndman RJ and Khandakar Y (2008). “Automatic time series
forecasting: the forecast package for R.” <em>Journal of Statistical
Software</em>, <em>26</em>(3), pp. 1-22. &lt;URL: <a
href="http://www.jstatsoft.org/article/view/v027i03"
class="uri">http://www.jstatsoft.org/article/view/v027i03</a>&gt;.</p>
<p>Venables, W. N. &amp; Ripley, B. D. (2002) Modern Applied Statistics
with S. Fourth Edition. Springer, New York. ISBN 0-387-95457-0</p>
<p>David Stoffer (2016). astsa: Applied Statistical Time Series
Analysis. R package version 1.7. <a
href="https://CRAN.R-project.org/package=astsa"
class="uri">https://CRAN.R-project.org/package=astsa</a></p>
<p>Andrej-Nikolai Spiess (2014). qpcR: Modelling and analysis of
real-time PCR data. R package version 1.4-0. <a
href="https://CRAN.R-project.org/package=qpcR"
class="uri">https://CRAN.R-project.org/package=qpcR</a></p>
<p>Nau, Robert. “Statistical Forecasting: Notes on Regression and Time
Series Analysis.”<br />
Statistical Forecasting: Notes on Regression and Time Series Analysis,
Duke<br />
University, Sept. 2017, people.duke.edu/~rnau/411home.htm.</p>
<p>Shumway, Robert H., and David S. Stoffer. Time Series Analysis and
Its Applications: with R Examples. 2nd ed., Springer, 2006.</p>
<p>Metcalfe, Andrew V., and Paul S.P. Cowpertwait. Introductory Time
Series with R. Springer New York, 2009.</p>
</div>
<div id="appendix" class="section level1">
<h1>Appendix</h1>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pretty much all code is included in the body of the report</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>fit211<span class="sc">$</span>coef[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="co"># the 2 AR coefficients</span></span></code></pre></div>
<pre><code>##         ar1         ar2 
##  0.02867388 -0.06710986</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co"># RESIDUALS</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># residual plots have clear heteroskedasticity</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(resids112, <span class="at">main =</span> <span class="st">&quot;ARIMA(1,1,2) Residuals&quot;</span>)</span></code></pre></div>
<p><img src="bitcoin_files/figure-html/spec.arma%20and%20plot.roots-1.png" width="672" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.ts</span>(resids211, <span class="at">main =</span> <span class="st">&quot;ARIMA(2,1,1) Residuals&quot;</span>)</span></code></pre></div>
<p><img src="bitcoin_files/figure-html/spec.arma%20and%20plot.roots-2.png" width="672" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># QQ-plots of residuals</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(resids112, <span class="at">main =</span> <span class="st">&quot;Standardized Residuals of ARIMA(1,1,2)&quot;</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(resids112)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(resids211, <span class="at">main =</span> <span class="st">&quot;Standardized Residuals of ARIMA(2,1,1)&quot;</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(resids211)</span></code></pre></div>
<p><img src="bitcoin_files/figure-html/spec.arma%20and%20plot.roots-3.png" width="672" /></p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ACF of residuals</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># shows they are uncorrelated at every lag i.e. white noise</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(resids112) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;ARIMA(1,1,2) Residuals&#39; ACF&quot;</span>)</span></code></pre></div>
<p><img src="bitcoin_files/figure-html/spec.arma%20and%20plot.roots-4.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(resids211) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;ARIMA(2,1,1) Residuals&#39; ACF&quot;</span>)</span></code></pre></div>
<p><img src="bitcoin_files/figure-html/spec.arma%20and%20plot.roots-5.png" width="672" /></p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ACF of squared residuals</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># not uncorrelated, i.e. not white noise</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(resids112<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;ARIMA(1,1,2) Squared Residuals&#39; ACF&quot;</span>)</span></code></pre></div>
<p><img src="bitcoin_files/figure-html/spec.arma%20and%20plot.roots-6.png" width="672" /></p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggAcf</span>(resids211<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;ARIMA(2,1,1) Squared Residuals&#39; ACF&quot;</span>)</span></code></pre></div>
<p><img src="bitcoin_files/figure-html/spec.arma%20and%20plot.roots-7.png" width="672" /></p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
